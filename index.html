<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Load the blocking script first -->
    <script src="/block-share-modal.js"></script>

    <!-- Immediate fix for share-modal.js -->
    <script>
      (function() {
        console.log('Initializing protective script');
        
        // Pre-define any expected global objects
        window.shareModalInit = function() { console.log('Intercepted shareModalInit'); };
        
        // Create a mock interface for any problematic elements
        window.__mockShareElement = {
          addEventListener: function(event, callback) { 
            console.log('Mock addEventListener called for event:', event);
            // If it's a load event, call the callback immediately with a mock event
            if (event === 'load') {
              setTimeout(function() { 
                callback({ type: 'load', target: window.__mockShareElement });
              }, 10);
            }
          },
          removeEventListener: function() {},
          click: function() {},
          style: { display: 'none' }
        };
        
        // Patch document.querySelector to return mock objects for share buttons
        const originalQuerySelector = document.querySelector;
        document.querySelector = function(selector) {
          if (selector && typeof selector === 'string' && 
              (selector.includes('share') || selector.includes('sharing'))) {
            console.log('Intercepted querySelector for:', selector);
            return window.__mockShareElement;
          }
          return originalQuerySelector.call(document, selector);
        };
        
        // Similarly patch document.getElementById
        const originalGetElementById = document.getElementById;
        document.getElementById = function(id) {
          if (id && typeof id === 'string' && 
              (id.includes('share') || id.includes('sharing'))) {
            console.log('Intercepted getElementById for:', id);
            return window.__mockShareElement;
          }
          return originalGetElementById.call(document, id);
        };

        // Block any external share-modal.js script
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'childList') {
              mutation.addedNodes.forEach(function(node) {
                if (node.nodeName === 'SCRIPT') {
                  const scriptNode = node;
                  if (scriptNode.src && scriptNode.src.includes('share-modal.js')) {
                    console.log('Blocked external share-modal.js script:', scriptNode.src);
                    scriptNode.parentNode.removeChild(scriptNode);
                  }
                }
              });
            }
          });
        });
        
        // Start observing
        observer.observe(document, { childList: true, subtree: true });
      })();
    </script>

    <!-- Critical CSS -->
    <style>
      /* Critical rendering path styles */
      body, html {
        margin: 0;
        padding: 0;
        height: 100%;
      }
      #root {
        min-height: 100%;
      }
      /* Initial loading state */
      .app-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #f9fafb;
        color: #3B82F6;
        font-family: sans-serif;
      }
    </style>

    <!-- Resource hints - using preconnect instead of preload -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://i.ibb.co" />
    
    <!-- Removed problematic preload links -->

    <!-- Primary Meta Tags -->
    <title>تطبيق السهم للتسكين الطلابي - منصة شاملة للإسكان الطلابي في مصر</title>
    <meta name="title" content="تطبيق السهم للتسكين الطلابي - منصة شاملة للإسكان الطلابي في مصر" />
    <meta name="description" content="تطبيق السهم للتسكين هو منصة متكاملة تسعى لتوفير حلول سكنية مناسبة للطلاب بطريقة سهلة وآمنة، بواجهة عربية سلسة ومميزات متعددة تلبي احتياجات الطلاب في مختلف المراحل الدراسية." />
    <meta name="keywords" content="تسكين طلابي, سكن طلاب, إسكان جامعي, تطبيق السهم, سكن طلابي مصر, حجز سكن طلابي, شقق طلابية, غرف مشتركة, استوديوهات طلابية, سكن جامعة سيناء" />
    <meta name="author" content="شركة السهم للتسكين الطلابي" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="Arabic" />
    <meta name="revisit-after" content="7 days" />

    <!-- Performance optimizations -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no" />

    <!-- Geo Tags -->
    <meta name="geo.region" content="EG" />
    <meta name="geo.country" content="Egypt" />
    <meta name="geo.placename" content="Egypt" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://elsahm-ar.netlify.app/" />
    <meta property="og:title" content="تطبيق السهم للتسكين الطلابي - منصة شاملة للإسكان الطلابي" />
    <meta property="og:description" content="منصة متكاملة للإسكان الطلابي تجعل البحث عن السكن سهلاً وآمناً وفعالاً. بحث متقدم، حجز إلكتروني، دفع آمن، ومجتمع طلابي متفاعل." />
    <meta property="og:image" content="https://i.ibb.co/rK72d17L/app-1.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:locale" content="ar_EG" />
    <meta property="og:site_name" content="تطبيق السهم للتسكين الطلابي" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://elsahm-ar.netlify.app/" />
    <meta property="twitter:title" content="تطبيق السهم للتسكين الطلابي - منصة شاملة للإسكان الطلابي" />
    <meta property="twitter:description" content="منصة متكاملة للإسكان الطلابي تجعل البحث عن السكن سهلاً وآمناً وفعالاً" />
    <meta property="twitter:image" content="https://i.ibb.co/rK72d17L/app-1.png" />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://elsahm-ar.netlify.app/" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="https://i.ibb.co/rK72d17L/app-1.png" />

    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json" />

    <!-- Theme Color -->
    <meta name="theme-color" content="#3B82F6" />
    <meta name="msapplication-TileColor" content="#3B82F6" />

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "تطبيق السهم للتسكين الطلابي",
      "alternateName": "السهم للتسكين",
      "description": "منصة متكاملة للإسكان الطلابي تجعل البحث عن السكن سهلاً وآمناً وفعالاً",
      "url": "https://elsahm-ar.netlify.app",
      "applicationCategory": "LifestyleApplication",
      "operatingSystem": "Android",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "EGP"
      },
      "author": {
        "@type": "Organization",
        "name": "شركة السهم للتسكين الطلابي",
        "url": "https://elsahm-ar.netlify.app"
      },
      "publisher": {
        "@type": "Organization",
        "name": "شركة السهم للتسكين الطلابي",
        "logo": {
          "@type": "ImageObject",
          "url": "https://i.ibb.co/rK72d17L/app-1.png"
        }
      },
      "inLanguage": "ar",
      "audience": {
        "@type": "Audience",
        "audienceType": "Students"
      },
      "featureList": [
        "البحث المتقدم عن السكن",
        "عرض تفاصيل شاملة للسكن",
        "الحجز والدفع الإلكتروني",
        "حساب شخصي متكامل",
        "نظام الإشعارات والتنبيهات",
        "نظام تقديم الشكاوى والدعم",
        "المجموعات والتواصل"
      ]
    }
    </script>
  </head>

  <body>
    <div id="root">
      <!-- Fallback content while JavaScript loads -->
      <div class="app-loading">
        <div>جاري تحميل التطبيق...</div>
      </div>
    </div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- Inline script to remove loader once app renders -->
    <script>
      window.addEventListener('load', function() {
        const loader = document.querySelector('.app-loading');
        if (loader) {
          setTimeout(() => {
            loader.style.display = 'none';
          }, 500);
        }
      });
    </script>
  </body>
</html>
